package er.indexing.example;
// Generated by the WOLips Templateengine Plug-in at 12.06.2008 11:20:01

import com.webobjects.appserver.WOActionResults;
import com.webobjects.appserver.WORequest;
import com.webobjects.eocontrol.EOEditingContext;

import er.directtoweb.ERD2WDirectAction;
import er.indexing.ERIndex;
import er.indexing.example.eof.AssetGroup;
import er.indexing.example.eof.Tag;

public class DirectAction extends ERD2WDirectAction {

    public DirectAction(WORequest aRequest) {
        super(aRequest);
    }
   
    /**
     * Checks if a page configuration is allowed to render.
     * Provide a more intelligent access scheme as the default just returns false. And
     * be sure to read the javadoc to the super class.
     * @param pageConfiguration
     * @return
     */
    protected boolean allowPageConfiguration(String pageConfiguration) {
        return true;
    }

    public WOActionResults defaultAction() {
        EOEditingContext ec = session().defaultEditingContext();
        Tag tag = Tag.clazz.allObjects(ec).lastObject();
        AssetGroup assetGroup = AssetGroup.clazz.allObjects(ec).lastObject();
        ERIndex eofStore = Application.model.indexNamed("AssetInEOFStore");
        ERIndex fileStore = Application.model.indexNamed("AssetInFileStore");
        log.info("fileStore: " + fileStore.find(ec, "tags.name", tag.name()).count());
        log.info("eofStore: " + eofStore.find(ec, "tags.name", tag.name()).count());
        log.info("fileStore: " + fileStore.find(ec, "assetGroup.name", assetGroup.name()).count());
        log.info("eofStore: " + eofStore.find(ec, "assetGroup.name", assetGroup.name()).count());
        return pageWithName(Main.class.getName());
    }
}