package er.ajax;

// Generated by the WOLips Templateengine Plug-in at Oct 18, 2006 6:24:40 PM

import com.webobjects.appserver.WOActionResults;
import com.webobjects.appserver.WOComponent;
import com.webobjects.appserver.WOContext;
import com.webobjects.appserver.WOResponse;

/**
 * AjaxInPlace is a generalization of the AjaxInPlaceEditor.  To use this component, you
 * must wrap an ERXWOTemplate named "view" and an ERXWOTemplate named "edit".
 * <br />
 * For instance:<br />
 * <br />
 * HTML:
 * <pre>
 * &lt;webobject name = "ExampleInPlace"&gt;
 *    &lt;webobject name = "View">View: &lt;webobject name = "Value"/&gt;&lt;/webobject&gt;
 *    &lt;webobject name = "Edit">Edit: &lt;webobject name = "ValueField"/&gt;&lt;/webobject&gt;
 * &lt;/webobject&gt;
 * </pre>
 * 
 * WOD:
 * <pre>
 * ExampleInPlace : AjaxInPlace {
 * }
 * 
 * View : ERXWOTemplate {
 *    templateName = "view";
 * }
 * 
 * Value : WOString {
 *    value = value;
 * }
 * 
 * Edit : ERXWOTemplate {
 *    templateName = "edit";
 * }
 * 
 * ValueField : WOTextField {
 *    value = value;
 * }
 * </pre>
 * 
 * @binding class the class used on the top container
 * @binding id the id used on various parts of this component
 * @binding saveLabel the label to show on the save button
 * @binding cancelLabel the label to show on the cancel button
 * @binding saveAction the action to invoke on save
 * @binding cancelAction the action to invoke on cancel
 * @binding saveClass the class of the save button
 * @binding onSaveClick the action to fire when save is clicked
 * @binding onSaveSuccess the javascript function to execute after a successful save
 * @binding onSaveFailure the javascript function to execute after a failed save
 * @binding onSaving the javascript action to fire when saving
 * @binding cancelClass the class of the cancel button
 * @binding onCancelClick the action to fire when cancel is clicked
 * @binding onCancelSuccess the javascript function to execute after a successful cancel
 * @binding onCancelFailure the javascript function to execute after a failed cancel
 * @binding onEditClick the action to fire when edit mode is triggered
 * @binding onEditing the javascript action to fire when editing mode is loading
 * @binding onCancelling the javascript action to fire when cancelling
 * @binding onRefreshComplete the javascript function to execute after refreshing the container
 * 
 * @author mschrag
 */
public class AjaxInPlace extends WOComponent {
  private boolean _editing;
  private String _id;

  public AjaxInPlace(WOContext context) {
    super(context);
  }

  public boolean synchronizesVariablesWithBindings() {
    return false;
  }

  public void appendToResponse(WOResponse aResponse, WOContext aContext) {
    if (canGetValueForBinding("id")) {
      _id = (String)valueForBinding("id");
    }
    else {
      _id = AjaxUtils.toSafeElementID(aContext.elementID());
    }
    super.appendToResponse(aResponse, aContext);
  }

  public String updateFunctionName() {
    return _id + "Update();";
  }

  public String id() {
    return _id;
  }

  public boolean editing() {
    return _editing;
  }
  
  public WOActionResults startEditing() {
    _editing = true;
    return null;
  }
  
  public WOActionResults save() {
    WOActionResults results = (WOActionResults) valueForBinding("saveAction");
    _editing = false;
    // ignore results
    return null;
  }

  public WOActionResults cancel() {
    WOActionResults results = (WOActionResults) valueForBinding("cancelAction");
    _editing = false;
    // ignore results
    return null;
  }

}