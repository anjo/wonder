<WEBOBJECT NAME=PageWrapper1><b>The Best Kept Secret of The Best Kept Secret: &nbsp;Part 2</b><br>
<P>DirectToWeb. &nbsp;Any new words come to mind? &nbsp;Maybe, really-flexible -framework-for-creating-dynamic-WOComponents? &nbsp;No, probably not yet. &nbsp;So for the observant reader, what is the really cool part of DirectToWeb that we looked at in Part 1? &nbsp;Easy. &nbsp;DirectToWeb allows for the reuse of the most important components of a project .... the ones the graphic design artists spent hours and hours designing. &nbsp;In a normal WebObjects application every time you want to display the contents of an EOEnterpriseObject or a list of objects, you normally have to develop a new WOComponent , get the look and feel right, get all of the properties showing up correctly, set date and number formatters, etc. &nbsp;Time consuming. &nbsp;If now you want a limited view, no problem just hack in a WOConditional here and there, and presto limited view. &nbsp; Now what about the customer service agent who needs to also look at this EnterpriseObject? &nbsp;No problem, just add a few more WOConditonals ... you get the idea. &nbsp;Now you have this Frankenstein component that so heavily depends on user state and user type that the only way you can possibly reuse this component is by cutting and pasting bits and pieces into other components. &nbsp;Sound familiar? </P>
<P>So, how does DirectToWeb help you solve this problem? &nbsp;Simple, for the style of pages that you find yourself using over and over again (inspect pages, tab inspect pages, wizard creation pages, list pages, edit pages, ect) DirectToWeb provides an extremely robust framework for reusing the part that requires the most work, the look of these templates. &nbsp;In the first article we looked at how the DirectToWeb List interface and embedded D2WList component could be used with a custom template. &nbsp;A custom template being a generic WOComponent that can be customized to a certain look and feel while at the same time retaining its extremely dynamic nature. &nbsp;In the list example we just displayed a list of property keys that just spit out what was in the database. &nbsp;I'll be the first to admit that really without being able to interact with the list of objects, a list for the sake of a list is not very exciting, nor very useful. &nbsp;In this article we will explore how to get our own components into the list and then into a DirectToWeb inspect page, as well as using a custom template for inspecting. &nbsp;If you haven't read the first article on DirectToWeb located here, I would highly suggest you take five minutes and at least skim over it as most of what will be presented in this article directly builds upon concepts introduced in the first article.</P>
<b>Common DirectToWeb Questions</b><br>
<p>After the
first article went up on Stepwise I received a number of questions and
comments. &nbsp;Thank you very much for the wonderful feedback and please keep
it coming! &nbsp;Before moving into the heart of this article I thought I would
spend a bit of time going over a few of the more common questions I received.</p><p><b>How does DirectToWeb render a page?</b> &nbsp;The way DirectToWeb renders a page is actually fairly straight forward. &nbsp;The heart of DirectToWeb is the rule engine. &nbsp;It is the rule engine's responsibility to answer questions. &nbsp;So, let's imagine that we have a page configuration named 'foo.' &nbsp;This page configuration has a task (list), an Entity (Bar) and an array of displayPropertyKeys((barName)). &nbsp;The object that embodies the rule engine in DirectToWeb is the D2WContext. &nbsp;The way the D2WContext answers questions is through key-value coding. &nbsp;So imagine we want to know what the displayPropertyKeys are in the page configuration 'foo.' &nbsp;This bit of code could find that out for you:</p><code>D2WContext myContext = new
D2WContext();</code><br>
<code>myContext.takeValueForKey(&quot;foo&quot;,
&quot;pageConfiguration&quot;);</code><br>
<code>NSArray displayPropertyKeys = (NSArray)myContext.valueForKey(&quot;displayPropertyKeys&quot;);</code><br>
<P>So how did the D2WContext know to return the correct array given just a pageConfiguration? &nbsp;Easy, the D2WContext resolved a few rules. &nbsp;Rule resovling is fairly straight forward, in the above example a key 'pageConfiguration' was set to a value 'foo' on the D2WContext, next a question was asked, essentially "What are your displayPropertyKeys?." &nbsp;To answer this question the D2WContext first asks itself "What are all the possible rules I have that will answer the above question?" &nbsp;Given that rule set the D2WContext then sorts the rules by priority (that's the number on the right hand side in Rule Editor), once the rules have been sorted by priority the D2WContext returns the rule with the highest priority (it also caches this result so that if asked again it won't have to perform the sort all over again). &nbsp;Given a tie, meaning two rules hit the criteria and both have the same priority the D2WContext will choose the most specific rule, ie the rule with the most cluases. &nbsp;These are the basics, don't worry if it doesn't make perfect sense right now, with a little playing around I the above should become more clear. &nbsp;If you would like a more detailed exaplanation of how DirectToWeb resolves rules I would refer you to the DirectToWeb article "Developing WebObjects Applications With DirectToWeb" in the WOInfoCenter. Returning to the above code snippet, if you look in the DemoListTemplate WOComponent from the first article (also used in this article), you will find that the WORepetion that displays the array of displayPropertyKeys for a given list page configuration has the following bindings:</P>
<code>list = d2wContext.displayPropertyKeys</code><br>
<code>item = d2wContext.propertyKey</code><br>
<p>In this way the repetition will be enumerating through the displayKeys and
setting the propertyKey on the context to the current displayPropertyKey.
&nbsp;We will cover more of the D2WContext object in another article.
&nbsp;Also note that you should never have to programmatically create a
D2WContext, DirectToWeb handles all that for you.</P>
<b>Performance. &nbsp;What about performance of DirectToWeb?</b> &nbsp;In WebObjects 4.5 DirectToWeb has been tuned and optimized so that dynamic pages only take about 25% longer to render than a regular WebObjects component of the same complexity. &nbsp;So the real question you should be thinking is gee, how did they make DirectToWeb so fast? &nbsp;Simple, the D2WContext caches rules as they fire. &nbsp;So the first time DirectToWeb renders a page, that page will render slower than any other time that page is rendered. &nbsp;The rule caching mechanism and performance tuning will be covered in a later article. &nbsp;For now just know that once the rule cache has &quot;warmed up&quot;, to use the EOF term, page rendering is not noticeably different compared to a static WebObjects page.<p><b>How are DirectToWeb and
DirectToJavaClient related?</b> &nbsp;Good question. &nbsp;DirectToJavaClient is built upon the same underlying rule engine as DirectToWeb, so if you are interested in learning more about how DirectToJavaClient's rule engine works, here is a pretty good place. &nbsp;Where DirectToJavaClient differs significantly from DirectToWeb is that instead of spitting out html it spits out xml, which is used to dynamically build the interface to an applet. &nbsp;DirectToJavaClient is an incredible piece of technology which really pushes the limits , but that's a story for another time ;)</P>
<p><b>Custom Components. &nbsp;How can I get custom logic into a dynamic page?</b> &nbsp;Good question. &nbsp;First we need to differentiate bewteen custom property level components and custom page level components, becuase in DirectToWeb we hvae both. &nbsp;I custom page level component is referred to as a template and is used to add a custom look to an entire page. &nbsp;This was demonstrated in the first article and is extended in this article. &nbsp;The second type of custom component is a property level component. &nbsp;These are the components that are used to display a particular propertyKey or attribute. &nbsp;Property level custom components are the topic of this article, so keep reading to learn about all these wacky and wild components. &nbsp;If you have any other questions on DirectToWeb, please send them on, and I will try to answer them in a future article. &nbsp;Before reading further, it would be a really good idea to download the example project. It contains all of the code, rules and links to pages referenced below.</p>
<b>Custom Property Level Components in DirectToWeb</b><br>
<p>In the context of DirectToWeb there are two
different kinds of property level custom components. &nbsp;A custom property level component being a
component that is used instead of the normal property level display component, i.e. instead of
a D2WDisplayString or a D2WDisplayDate. &nbsp;Recall that in the list example
from the first article all of the attributes being displayed were either a
string or a date. &nbsp;In this case DirectToWeb was using the default
components to display this information, i.e. D2WDisplayString and
D2WDisplayDate. &nbsp;Now imagine that we don't want the name attribute of the
Movie to show up as just a String, but instead we want the name to be a
hyperlink that takes us to a page that displays all of the information about
that movie. &nbsp;How would we do that? &nbsp;With a custom component of
course.</p>
<p>The first kind of custom component is a direct subclass of D2WComponent. &nbsp;These components are only available within a DirectToWeb page, for example the D2WDisplayString, a subclass of D2WComponent, cannot be used outside the context of a DirectToWeb page. &nbsp;These types of custom components are generally used to create new ways of editing attributes. &nbsp;These will be covered in a future article about EnterpriseObject editing and creation. &nbsp;The second kind of custom component is a plain vanilla subclass of WOComponent. &nbsp;When used with DirectToWeb this component will be handed an object and a key through its bindings. &nbsp;With these two bits of information the component can do whatever it likes. &nbsp;I usually like to make these components non-synchronizing and stateless, seeing as they can be used many times on a given page. &nbsp;If you don't make your custom component non-synchronizing then you will need to have a variable of the type EOEnterpriseObject named 'object' and a String variable named 'key' in your component.&nbsp;Let's actually look at the code from a custom component named LinkToViewMovie1.java taken from the D2WInspectExample project:</p>
<code>public class LinkToViewMovie1 extends
WOComponent {</code><br>
<BR><code>&nbsp;&nbsp;&nbsp;&nbsp;public boolean isStateless() { return true; }</code><br>
<br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;public Object object() { return
valueForBinding(&quot;object&quot;); }</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;public String key() { return (String)valueForBinding(&quot;key&quot;);
}</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;public Movie movie() {</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (Movie)(object()
instanceof Movie ? object() : object().valueForKeyPath(key()));</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;}</code><br>
<br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;public WOComponent view() {</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MyD2WInspect1 view =
(MyD2WInspect1)pageWithName(&quot;MyD2WInspect1&quot;);</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;view.setMovie(movie());</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;view.setBackPage(context().page());</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return view;</code><br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;}</code><br>
<code>}</code><br>
<p>Looking at the .wod of this component we can see that the only function of this component is to display the movie's name
in a hyperlink with the action method bound to the view() method .&nbsp;So how do we get this component into the
DirectToWeb list? &nbsp;With a rule of course.&nbsp;Well actually with two rules, they are:</p>
<code>(pageConfiguration = 'ListMovies1') and
(propertyKey = 'title') =&gt; componentName = &quot;D2WCustomComponent&quot;</code><br>
<br>
<code>(pageConfiguration = 'ListMovies1') and (propertyKey = 'title') =&gt;
customComponentName = &quot;LinkToViewMovie1&quot;</code><br>
<p>Tiny bit of review on the DirectToWeb rule system: &nbsp;All of the rules for a project are found in the DirectToWeb model file, named user.d2wmodel in the example project. &nbsp;To edit/create and find rules we use the RuleEditor application. &nbsp;The 'Find' command is your friend. &nbsp;Want to see all the rules associated with the propertyKey title? &nbsp;Type 'title' in the find box and presto, every rule that has 'title' in it appears in the list. &nbsp;Note that this will find all rules that have title in either the lhs (left hand side, the part of the rule before the =&gt; above) or the rhs (right hand side, the part after the =&gt;).</p>
<p>The two rules above tell DirectToWeb two things, first when displaying the propertyKey 'title' I want to use a custom component as oppossed to the built-in D2WDisplayString component and second, the custom component's name is 'LinkToViewMovie1.' &nbsp;The generated list page will now look like this:</p>
<WEBOBJECT NAME=Image1></WEBOBJECT><p>As you can see in the above list the movie's title is encapsulated with a hyperlink. &nbsp;Also note that the name at the top of the column displays 'Movie Title,' instead of Title which is the name of the attribute in the EOModel &nbsp;By default DirectToWeb beautifies the attribute's name, so 'title' would become 'Title' and 'movieRating' would become 'Movie Rating.' &nbsp;Often however (as anyone who has ever had to work with a content team can attest to) the name in the EOModel will not be the name that you would like the users of the application to see. &nbsp;In this case the display name can be specified with a rule, like so:</p>
<code>(entity.name = 'Movies') and
(propertyKey = 'title') =&gt; displayNameForProperty = &quot;Movie Title&quot;</code><br>
<p>Notice that this rule does not include a
pageConfiguration in the lhs of the rule. &nbsp;The scope of this rule is not
tied to a single pageConfiguration, i.e. a single dynamic page. &nbsp;Instead
this rule will apply anytime you are inspecting, listing, editing or searching
on an object whose entity name is 'Movie.' &nbsp;This is a very, very powerful concept and the main reason why you want to have a rule system instead of a plain lookup mechanism or code. &nbsp;For example imagine you wanted to build two build a suite of applications and have the Movie entity's title appear as 'Movie Title' everywhere it is used, except when listing Movie entities or when you are in the customer service application. &nbsp;Building up this logic with a few rules is pretty simple, but trying to implement the above case in code would be non-trival and probabely require constant fiddling everytime you wanted a different behaviour. &nbsp;The DirectToWeb way is the exact opposite, provide a default general rule and then override that rule in specific pageConfigurations or applications. &nbsp;Gernally when writing rules for a large project you will have two rule files, the rule file at the business logic layer and a rule file at the application layer. &nbsp;A good example of a rule that belongs in the business logic layer or framework is the above rule. &nbsp;Once that rule is in place everytime the title attribute of a Movie object is displayed it will be displayed as 'Movie Title' instead of 'Title'. &nbsp;A good example of a rule that belongs in the application layer is any rule that deals with a particular pageConfiguration. &nbsp;Remember a pageConfiguration is the equivalent to a static WOComponent's name, so in most cases you wouldn't place specific WOComponents in the business logic layer, likewise rules that correspond to a particular pageConfiguration mostly belong in the application rule file. &nbsp;To see the above rule in action click on one of the movie title's hyperlinks from the above list. &nbsp;The component
returned from the view method above should look like this:</p>
<WEBOBJECT NAME=Image2></WEBOBJECT><p>Notice that the attribute 'title' is still
getting displayed as 'Movie Title' from the display rule above. &nbsp;This can
be extremely handy, especially if you have a fickle content team (&quot;We
realize you just changed the entire site to be Movie this and Movie that, but
well we decided that we really like the word Film better ...&quot;). &nbsp;From
the above screen shot you can get a feel for the plain vanilla D2WInspect
component which is embedded in the component '<code>MyD2WInspect1</code>'. &nbsp;The D2WInspect component is very similar
to the D2WList component, i.e. you give it an object, an entity and optionally
a pageConfiguration and it produces a D2WInspect page inside your WOComponent.
&nbsp;Notice how easy it is to move between DirectToWeb dynamic components (the
page with the list in it) and regular WOComponents ('MyD2WInspect1' is a
regular WOComponent) by using custom components.</p>
<p>Let's jazz things up a bit, actually let's jazz things up a lot. &nbsp;In the list page let's add another column that lists the number of reviews of that movie with a hyperlink to view the list of reviews. &nbsp;To show that the display keys of the list don't actually have to correspond to attribute keys, the key added to the display keys will be 'dummy,' likewise let's add a corresponding displayNameForProperty so that 'Dummy' won't show up at the top of the column. &nbsp;Let's also format the movie revenue number as '$ #,##0.00.' &nbsp;In the movie inspect page let's display the relationship to the plot summary just like a normal attribute, and let's display a table of the directors (a flattened relationship) showing each director's first and last name. &nbsp;Plus let's add a link to write a movie review in the inspect page. &nbsp;To make things even more interesting let's use a custom inspect template instead of the built-in template (just like we are currently using for the list pages). &nbsp;Plus let's do all this with dynamic pages (no D2WInspect or D2WList components embedded in normal WOComponents), three custom components and 31 rules in less than nine minutes. &nbsp;Ya think it's possible? &nbsp;I do. &nbsp;The final product will look like this:</p>
<p>Movie List Page:</p>
<WEBOBJECT NAME=Image12></WEBOBJECT>
<p>Review List Page:</p>
<WEBOBJECT NAME=Image3></WEBOBJECT>
<p>Movie Inspect Page:</p>
<WEBOBJECT NAME=Image11></WEBOBJECT>
<p>Write A Review Page:</p>
<WEBOBJECT NAME=Image10></WEBOBJECT><p>Note: when you try out the example project for
the first time on your machine you will notice that the number of reviews shows
up as &quot;No Reviews&quot; for all the movies. &nbsp;Little did I realize
when designing the example that the OpenBase Lite Movies database did not
include any reviews, thus the addition of the &quot;Write A&nbsp;Review
Page&quot;.</p>
<p>So where to begin? &nbsp;Let's start with the list page. &nbsp;It looks very similar to the first list page, except it has the added column 'Number of Reviews.' &nbsp;This is another custom component called 'LinkToViewReviews.' &nbsp;All it does is test if the number of reviews is greater than 0, if so it displays a hyperlink to another dynamic list page displaying the movie's reviews, if not it displays 'No Reviews.' &nbsp;As indicated above, the key in the displayPropertyKeys is 'dummy' and the corresponding componentName, customComponentName, and displayNameForProperty have all been set for the entity. &nbsp;They look like this:</p>
<code>(entity.name = 'Movie') and
(propertyKey = 'dummy') =&gt; componentName = &quot;D2WCustomComponent&quot;</code><br>
<code>(entity.name = 'Movie') and (propertyKey = 'dummy') =&gt;
customComponentName = &quot;LinkToViewReviews&quot;</code><br>
<code>(entity.name = 'Movie') and (propertyKey = 'dummy') =&gt;
displayNameForProperty = &quot;Number of Reviews&quot;</code><br>
<p>Note that these three rules correspond to the following screen shot in Rule
Editor:</p>
<WEBOBJECT NAME=Image4></WEBOBJECT><p>Notice also that in the inspect page we have
included the key dummy in the displayPropertyKeys of the inspect page and sure
enough all three of the above rules fire. &nbsp;Adding the formatter to the
revenue attribute is really straight forward. &nbsp;Simply add the rule:</p>
<code>(propertyKey = 'revenue') and
(pageConfiguration = 'ListMovies2') =&gt; formatter = &quot;$ #,##0.00&quot;</code><br>
<p>This formatter rule functions just like the
WebObjects binding numberFormat or dateFormat on a WOString. &nbsp;So if you
wanted all numbers being displayed to by default be formatted with the format
&quot;$ #,##0.00&quot; you could add the rule:</p>
<code>(attribute.valueClassName = 'NSNumber')
or (attribute.valueClassName = 'NSDecimalNumber') =&gt; formatter = &quot;$
#,##0.00&quot;</code><br>
<p>Note: This and many other high level hooks can be very handy for localizing
applications, but that's a story for another time ;)</p>
<p>Notice here that we are using the key 'attribute' in the above rules. &nbsp;In the rule system, just as entity refers to the EOEntity of the object, attribute refers to the EOAttribute of the propertyKey if it is an attribute of the entity*. &nbsp;As you could probably infer, the rule system also has a key 'relationship', which corresponds to the EORelationship if the current propertyKey is a relationship of the entity. &nbsp;Notice also that the valueClassName in the above rules refers to the Obj-C class names, not the corresponding Java equivalent. &nbsp;Even though DirectToWeb is written entirely in Java, the rule system still uses the Obj-C class names and most importantly nil instead of null.</p>
<p>In the inspect page, everything is pretty
straight forward. &nbsp;If you open the rules and perform a find for
'InspectMovie1'. &nbsp;The following set of rules should come up:</p>
<WEBOBJECT NAME=Image5></WEBOBJECT><p>Note that we have specified the pageName in the
rules as 'DemoInspectTemplate.' &nbsp;This is the hook we use to specify our
own custom look and feel. &nbsp;The 'DemoInspectTemplate' is pretty much a
plain vanilla inspect page, but note that you have complete control over the
look and the feel. &nbsp;Want style sheet elements, easy as pie. &nbsp;Want
graphic images instead of displayNames, sure no problem you have the template. &nbsp;Note
that we have added one ability to the DemoInspectTemplate which is to disable
the 'edit' button. &nbsp; To do this we add the default rule:</p>
<code>*true* =&gt; isEntityEditable = &quot;true&quot; (BooleanAssignment)</code><br>
<p>To turn it off in the inspect configuration used, 'InspectMovie1' we simply add
the rule:</p>
<code>(pageConfiguration = 'InspectMovie1') =&gt; isEntityEditable =
&quot;false&quot; (BooleanAssignment)</code><br>
<p>Notice that the above two rules use
BooleanAssignment instead of the regular rule assignment. &nbsp;A screenshot of
what this type of assignment looks like in Rule Editor:</p>
<WEBOBJECT NAME=Image6></WEBOBJECT><p>So what is the difference between the default assignment and using a custom assignment class? &nbsp;By default the value part of the key-value pair of the rule is just a plist that gets turned into a String, NSArray or NSDictionary. &nbsp;For example, the displayPropertyKeys rule in Rule Editor looks like this:</p>
<WEBOBJECT NAME=Image7></WEBOBJECT><p>Whereas a rule for a displayNameForProperty will
look like this:</p>
<WEBOBJECT NAME=Image8></WEBOBJECT><p>Finally, if you wanted to have a rule that returns a dictionary it would look something like this:</p>
<WEBOBJECT NAME=Image9></WEBOBJECT><p>So if the rule engine is asked for any of the rhs keys from above (displayPropertyKeys, displayNameForProperty and dictionaryDemo), either a String , NSArray or NSDictionary object will be returned. &nbsp;So how do the BooleanAssignment and EntityAssignment differ? &nbsp;Simple, by providing a custom Assignment class DirectToWeb is able to return other objects, like for example Boolean and EOEntity objects. &nbsp;Note however that due to the Java Bridge Boolean objects get turned into Java Integer objects. &nbsp;In the next article we will look at adding our own custom assignment classes which can be a very powerful extension of DirectToWeb. (This is actually really simple, if you can't wait until the next article check the WOInfoCenter Assignment class for further information).</p>
<p>Back to the custom inspect page and its table of directors. &nbsp;How was this done? &nbsp;With four rules of course! &nbsp;First note that in the displayPropertyKeys &quot;directors&quot; appears. This is the name of the flattened relationship to the Talent entity. &nbsp;The component that DirectToWeb uses by default to display to-many relationships is called D2WDisplayToManyFault. &nbsp;This component appears the same way it did in the plain vanilla inspect page (a collapsible component with the directors first name displayed wrapped in a hyperlink that takes the user to another inspect page about the selected director). &nbsp;To create the look used on the above inspect page we simply tell DirectToWeb to use another component. &nbsp;We could have written our own custom component to display the list of directors first and last name in a table, however this would not be a very reusable approach. &nbsp;Instead what we want is a generic way to display a to-many relationship in a table. &nbsp;Well it turns out that DirectToWeb has a component named D2WDisplayToManyTable that does exactly what we need. &nbsp;To use this component to display the directors we need to specify four rules. &nbsp;They are:</p>
<code>(pageConfiguration = 'InspectMovie1') and (propertyKey = 'directors') =&gt;
componentName = &quot;D2WDisplayToManyTable&quot;<br>
<br>
(pageConfiguration = 'InspectMovie1') and (propertyKey = 'directors') =&gt;
disabled = &quot;true&quot; (BooleanAssignment)<br>
<br>
(pageConfiguration = 'InspectMovie1') and (propertyKey = 'directors') =&gt;
allowCollapsing = &quot;false&quot; (BooleanAssignment)<br>
<br>
(pageConfiguration = 'InspectMovie1') and (propertyKey = 'directors') =&gt;
keyWhenRelationship = &quot;fullName&quot;</code><br>
<p>The first rule tells DirectToWeb to use the component D2WDisplayToManyTable to display the relationship directors. &nbsp;The second rule 'disabled' tells DirectToWeb to not place a hyperlink to the director inspect page around each director. &nbsp;By setting the 'allowCollapsing' to false this tells DirectToWeb to not use a collapsible component around the D2WDisplayToManyTable component. &nbsp;The last rule, keyWhenRelationship, tells DirectToWeb what to display for each director. &nbsp;Note that fullName is not in the model, instead it is a method off of Talent that simply returns firstName() + &quot; &quot; + lastName().</p>
<p>As a preview of things to come in the movie
inspect page the key writeAReview was added to the displayPropertyKeys.
&nbsp;This key is used to get the custom component 'LinkToWriteAReview' into
the inspect page. &nbsp;This component displays the text &quot;Write A
Review&quot; in a hyperlink that when clicked creates a Review object and then
takes the user to a regular DirectToWeb edit page. &nbsp;Let's take a quick
peak at the code that creates the review object and returns the DirectToWeb
edit page. &nbsp;Here it is:</p>
<code>
&nbsp;&nbsp;&nbsp;public WOComponent writeReview() {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// This will be a peer of the
session's default editingContext.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EOEditingContext peer = new
EOEditingContext();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// The below methods would be better suited in the business logic. &nbsp;But for simplicity it it here.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EOClassDescription cd =
EOClassDescription.classDescriptionForEntityName(&quot;Review&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EOEnterpriseObject review =
cd.createInstanceWithEditingContext(peer,null);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peer.insertObject(review);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Movie localMovie =
(Movie)EOUtilities.localInstanceOfObject(peer, movie());<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (localMovie == null)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw
new RuntimeException(&quot;Attempting to create a review for a null
movie.&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localMovie.addObjectToBothSidesOfRelationshipWithKey(review,
&quot;reviews&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EditPageInterface epi =
(EditPageInterface)D2W.factory().pageForConfigurationNamed(&quot;CreateReview&quot;,
session());<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;epi.setObject(review);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;epi.setNextPage(context().page());<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Need to make sure that the
ec survives, ie after the EOUtilities.localInstanceOfObject method the ec could
be released.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peer.hasChanges();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (WOComponent)epi;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}</code><br>
<p>As you can see, it's all pretty straight forward. &nbsp;A peer context is created so that if the user hits the back button then s/he is not left with a dirty editing context. &nbsp;The page configuration &quot;CreateReview&quot; has the following four rules:</p>
<code>
(pageConfiguration = 'CreateReview') =&gt; task = &quot;edit&quot;<br>
<br>
(pageConfiguration = 'CreateReview') =&gt; entity = &quot;Review&quot;
(EntityAssignment)<br>
<br>
(pageConfiguration = 'CreateReview') =&gt; displayPropertyKeys =
&quot;(movie.title, reviewer, review)<br>
<br>
(pageConfiguration = 'CreateReview') and (propertyKey = 'movie.title') =&gt;
componentName = &quot;D2WDisplayString&quot;<br></code>
<p>Again, all pretty straight forward stuff. &nbsp;Note that by using a D2WDisplayString for the propertyKey 'movie.title' we have effectively made this attribute read-only.</p>
<b>Recap</b><br>
<P>So what the heck did we just cover? &nbsp;In a
nutshell we looked at how to use custom components in either a DirectToWeb list
or inspect page. &nbsp;We also explored more of how the rule system works, in particular
we looked at formatters, display names, EOAttributes and Boolean assignments.
&nbsp;We also looked at how to use a custom inspect template with DirectToWeb.
&nbsp;In a preview of things to come we showed how to create objects and edit
them with the standard DirectToWeb edit page. &nbsp;In the next article we will
be looking more at object creation, editing and validation as well as custom
assignment classes. &nbsp;Slightly more impressed with DirectToWeb yet?
&nbsp;If not at least give me the benefit of the doubt and read the next few
articles because believe me the best is yet to come!</P></WEBOBJECT>