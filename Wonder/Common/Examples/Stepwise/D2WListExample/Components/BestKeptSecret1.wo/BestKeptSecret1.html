	<WEBOBJECT NAME=PageWrapper1><BR><FONT SIZE=4><B>Direct To Web: Part 1</B></FONT><BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Direct To Web. &nbsp;What are some of the first words that come to your mind? &nbsp;Toy. &nbsp;Demo Ware. &nbsp;Not for real programers. &nbsp;Yeah I used to think that too. &nbsp;Then about five months ago I started working for Patrice Gautier (one of the original authors of DirectToWeb) at NetStruxr and everything changed. &nbsp;I have found DirectToWeb to be the most dynamic and flexible piece of software I have ever worked with, truly taking WebObjects design to another level. &nbsp;DirectToWeb is the best kept secret of WebObjects, which as we all can attest to is Apple's best kept secret. <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;So what is DirectToWeb? DirectToWeb originally started out as a way for non-technical developers to quickly produce an application and then mdify its look and feel at runtime through the use of a Java Applet named the Assistant. This probably sounds familiar. Instead what the team ended up developing was another layer onto of the WebObjects framework. A layer that abstracts and leverages WebObjects and EOF even further than you can possibly imagine. The only problem is that where as the rest of WebObjects has at least some documentation, DirectToWeb has extremely little. It is my hope that after three or four articles you will begin to glimpse the power beneath. &nbsp;In these articles we will start with the basics of DirectToWeb and work our way up.&nbsp;I thought I would first outline a few misconceptions that I had of DirectToWeb before I started working with it.<BR><BR><FONT SIZE=4><B> Common Misconceptions of DirectToWeb:</B></FONT> <BR><BR>1) &quot;Using DirectToWeb locks your whole app into being a 'DirectToWeb Application'.&quot; Not true at all. &nbsp;DirectToWeb does not change the way your app functions in the least. &nbsp;DirectToWeb is actually just a framework for creating dynamic pages on the fly based on a set of rules. &nbsp;To take advantage of DirectToWeb all that you have to do is add the DirectToWeb framework to your project and add a DirectToWeb rule file to your resources directory, just like an eomodel file (more on this in a bit). &nbsp; <BR><BR>2) &quot;DirectToWeb will never look like my application. &nbsp;I've seen the three looks they have and that just won't work for me.&quot; Not true at all. &nbsp;By default DirectToWeb uses one of the built in looks or templates. &nbsp;But as you will soon see it is rather easy create your own template with your own site's look and then tell DirectToWeb to use that instead of one of the bundled templates. &nbsp;This is not the same as freezing a page (the act of turning a dynamic DirectToWeb page into a static regular WOComponent). <BR><BR><FONT SIZE=4><B>Simple DirectToWeb List Pages</B></FONT><BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Before you read any further you will probably want to download the sample project DirectToWebListExample which contains all of the examples discussed below. &nbsp;The eomodel used for this article is the standard movies eomodel, so if you have WebObjects installed on your machine you should be able to build the application and have it just work. Using list pages is a really simple way to get to know the DirectToWeb world. &nbsp;A list page does exactly what its name implies, it lists objects. &nbsp;In its simplest form, it takes an array of objects and an entity name and does the rest for you. &nbsp;This is shown in the WOComponent MyDirectToWebListPage1.&nbsp;You can see this page by clicking on the link &quot;To List Page 1,&quot; from the main page of the example application &nbsp;Here all we have done is drop in a DirectToWebList component off of the DirectToWeb palette in WOBuilder and bound a list of Movie objects to the list binding and the string &quot;Movie&quot; to the entityName binding. &nbsp;This will spit out a plain vanilla DirectToWeb list page inside our standard WOComponent which will look like this:<BR><P ALIGN=CENTER><WEBOBJECT NAME=Image1></WEBOBJECT></P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notice that by default we have the ability to delete objects by clicking the trashcan on the right and to edit these objects by clicking on the edit button on the left. &nbsp;Also note that all of the attributes that are marked as class properties on the entity Movie are shown and that none of the relationships that are marked as class properties are shown. &nbsp;Now let's modify this behaviour to make the objects read only, get rid of the banner at the top and limit the display keys to title, dateReleased, rated and revenue. &nbsp;To do this we need to create a pageConfiguration or a set of rules that tells DirectToWeb how to render the page. &nbsp;The application that is used to edit and create rules is called RuleEditor and is located after the EOModeler icon in the drop down list under the WebObjects tab. &nbsp;RuleEditor edits and creates d2wmodel files which store all of the rules for a given application or framework. &nbsp;DirectToWeb also offers another means of editing rules called The Live Assistant. The Live Assistant is an applet that can be configured to startup when teh application is launched. &nbsp;The Live Assistant is a useful tool when getting started, but it hids alot of the power and flexibility that DirectToWeb offers. &nbsp;For this reason all the examples shown are done with the RuleEditor. &nbsp;At the moment DirectToWeb will only pick up model files that are named user.d2wmodel and d2w.d2wmodel, where typically the former resides in the resources directory of application projects and the later in the resources directory of framework projects, although nothing is stopping you from adding both a d2w and a user d2wmodel to a project.<BR><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To change the behaviour, we bind &quot;ListMovies2&quot; to the D2WList's binding pageConfiguration. The final product which is displayed in the WOComponent MyD2WListPage2. It should look something like this:<BR>
	<P ALIGN=CENTER><WEBOBJECT NAME=Image2></WEBOBJECT></P><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notice that
	now the banner and trashcan are gone and
	the editing icon has been replaced by an
	inspection icon (don't worry soon we will
	show how to use your own icons instead ;).
	&nbsp;To add the page configuration
	&quot;ListMovies2&quot; to the rules we
	first needed to add a user.d2wmodel to our
	project. To add a d2wmodel to our example
	project we open RuleEditor, selected new
	model and then chose the &quot;Save
	As&quot; option. &nbsp;We saved the file as
	user.d2wmodel in the project folder, then
	we chose &quot;Add Files To Project&quot;
	from inside Project Builder to add
	user.d2wmodel to the project's Resources.<BR><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Now for a quick'n dirty overview of the DirectToWeb rule system. &nbsp;DirectToWeb rules are very straightforward. &nbsp;A DirectToWeb rule is composed of four parts: the left hand side (lhs) or the condition in which the rule fires, the rigt hand side key (rhs), the right hand side value, and the priority. &nbsp;For example, the set of rules for the &quot;ListMovies2&quot; configuration is composed of five rules. &nbsp;If you open user.d2wmodel and select &quot;Filter Rules&quot; and type &quot;ListMovies2&quot; you should see six rules that look like this:<BR>
	<P ALIGN=CENTER><WEBOBJECT NAME=Image3></WEBOBJECT></P><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For now ignore the rule that has the Rhs key 'look'. &nbsp;These five rules tell
	DirectToWeb everything it needs to know about the pageConfiguration &quot;ListMovies2&quot;. &nbsp;Look at the top
	most rule:<BR><BR><code>pageConfiguration = 'ListMovies2' =&gt; task = &quot;list&quot;</code><BR><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This says for this configuration the task is 'list'. By default, another rule will fire that will look like this:<BR><BR><code>task = 'list' =&gt; pageName = 'DefaultD2WListTemplateName'</code><BR><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In this way DirectToWeb will know which template to use for the list, in other words all the D2WList component really is is a WOSwitchComponent where the componentName is bound to the value pageName from the rules. &nbsp;Now click on the rule:<BR><BR><code>pageConfiguration = 'ListMovies2' =&gt; entity = &quot;Movie&quot;</code><BR><BR>It should look like this:<BR><P ALIGN=CENTER><WEBOBJECT NAME=Image4></WEBOBJECT></P><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note that the type of class assignment isn't of the type Assignment, instead it says Custom with the string &quot;com.apple.yellow.directtoweb.EntityAssignment&quot; typed in the white box below. &nbsp;This will be covered in greater detail in another article, but for now just know that the only two special assignments are the EntityAssigment and the BooleanAssignment (click on the rule with the rhs readOnly to see the boolean assignment in action). &nbsp;In this way we can write rules that take advantage of the fact that the key entity represents an entity object. For instance, we could write the following rule if we wanted all objects whose entity is Movie to be readOnly by default:<BR><BR><code>entity.name = 'Movie' =&gt; readOnly = &quot;true&quot;</code><code>(com.apple.yellow.directtoweb.BooleanAssignment)</code><BR><BR>
	Now look at this rule:<BR><BR><code>*true* =&gt; look = &quot;NeutralLook&quot;</code><BR><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This rule does not have a lhs component, so we say that this is a default rule, or in this case the default 'look'. &nbsp;This is the only rule that you absolutely must have in your rule file. &nbsp;Without this rule, DirectToWeb will throw an exception when you attempt to render a dynamic page, even if you are not using any of the built-in DirectToWeb templates.<BR><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Now what if we don't want to have to have WOComponents that we have to maintain, but
	instead we would like them to be created on the fly. &nbsp;This is really simple. &nbsp;From the Main page are two
	links &quot;To List Page 3&quot; and &quot;To List Page 4&quot;. &nbsp;These produce almost the exact same pages
	as pages 1 and 2 except they are dynamicly constructed from the rule system. &nbsp;By clicking on &quot;Link To
	Page 4&quot; you should see a page that looks like this:<BR>
	<P ALIGN=CENTER><WEBOBJECT NAME=Image5></WEBOBJECT></P><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The only difference between the above page and &quot;To List Page 2&quot; is the return button at the bottom (not shown above) and hardcoded text &quot;This is an example of ...&quot; that was hardcoded into the WOComponent MyD2WListPage2. Also note that we still have the dynamic page being wrapped in our PageWrapper navigation component. &nbsp;The reason for this is that when DirectToWeb renders a top level dynamic page it will look for a component named PageWrapper in your project. If it finds one then it uses that to wrap the dynamic pages in when they are rendered, thus giving you the ability to wrap top level dynamic pages in your own look and feel. &nbsp;Note that only top level dynamic pages have the ability to pick up pageWrappers, embedded components like the D2WList do not display the pageWrapper. &nbsp;Want to use a different name than PageWrapper, say for situations where you don't want navigation shown or if you already have a navigation component named something else? Easy - add a rule with the lhs specified (pageConfiguration = 'APageConfig' or *true* to set the default) and the rhs equal to pageWrapperName = &quot;MyPageWrapperComponentName.&quot; &nbsp;The method to return the above page is located in Main.java and looks like:<BR><BR><code>&nbsp;&nbsp;&nbsp;&nbsp;public WOComponent myDirectToWebListPage4() {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ListPageInterface lpi = (ListPageInterface)DirectToWeb.factory().pageForConfigurationNamed(&quot;ListMovies2&quot;, session());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lpi.setNextPage(context().page());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lpi.setDataSource(((Session)session()).movieArrayDataSource());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (WOComponent)lpi; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;}</code><BR><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The method movieArrayDataSource off of session simply returns an EOArrayDataSource that contains all of the Movie enterprise objects.<BR>
	<BR>
	<FONT SIZE=4><B>Custom List Templates</B></FONT><BR><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Now for the finale ... adding your own look and feel to a DirectToWeb List.
	&nbsp;Let's look at the result before explaining how to get there. &nbsp;By clicking on the link &quot;To List
	Page 5&quot; you should see a page that looks like this:<BR>
	<P ALIGN=CENTER><WEBOBJECT NAME=Image6></WEBOBJECT></P><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;What you are probably thinking now is, &quot;This looks just like a DirectToWebList page!?!?! &nbsp;Where is our custom look?&quot; &nbsp;Well you are right, this is mainly because I completely lack graphic design ability. &nbsp;However, the really neat part is that the entire look of this page is generated from the template named DemoListTemplate. &nbsp;Here you have access to all of the images, all of the colors, fonts, everything. &nbsp;In fact it is fairly trival to integrate a stylesheet into this list component. &nbsp;You can add your own navigation bar, or buttons, whatever you like. &nbsp;Now the cool part. &nbsp;If you are using this style of approach and you have say ten pages displaying different lists of objects, and you need to change the color of text or backgound, you can make that change in one place and have the effect uniform across all places where that list template is used.<BR><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let's take a quick look at how we integrated DemoListTemplate into DirectToWeb. &nbsp;First, we subclassed com.apple.yellow.directtoweb.DirectToWebListPage with our own component called DemoListTemplate. &nbsp;Then, we added a new pageConfiguration &quot;ListMovies3&quot; and duplicated all of the rules from before (Note: not the most efficient number of rules if you look at the operators DirectToWeb has to offer, but I wanted to keep the rules simple), as well as adding two rules to the pageConfiguration:<BR><BR><code>pageConfiguration = 'ListMovies3' =&gt; pageName = &quot;DemoListTemplate&quot;</code><BR><BR>and<BR><BR><code>pageConfiguration = 'ListMovies3' =&gt; isEntityInspectable = &quot;false&quot; (com.apple.yellow.directtoweb.BooleanAssignment)</code><BR><BR>
	We also added a default value to the rules:<BR><BR><code>*true* =&gt; isEntityInspectable = &quot;true&quot; (com.apple.yellow.directtoweb.BooleanAssignment)</code><BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We did this so that we will always get a Boolean value back from the rules when we ask for the key: &quot;isEntityInspectable.&quot; &nbsp;Note, the rule system will be covered in far greater detail in another article. &nbsp;If you look at the code in DemoListTemplate.java we have only added two methods:<BR><BR><code>&nbsp;&nbsp;&nbsp;&nbsp;public boolean showReturn() { return nextPage()!=null; } &nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;public boolean isEntityInspectable() {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Integer isEntityInspectable=(Integer)d2wContext().valueForKey(&quot;isEntityInspectable&quot;);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return isEntityReadOnly() &amp;&amp; (isEntityInspectable!=null &amp;&amp; isEntityInspectable.intValue()!=0);<BR>&nbsp;&nbsp;&nbsp;&nbsp;}</code><BR><BR>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The first method is bound to a conditional that displays the &quot;Return&quot; button. &nbsp;By doing this we now have the ability to not show the Return button if we do not set the nextPage on the ListPageInterface. &nbsp;The second is a hook into the DirectToWeb rules that asks for the value of &quot;isEntityInspectable.&quot; &nbsp;If you delete the rule:<BR><BR><code>pageConfiguration = 'ListMovies3' =&gt; isEntityInspectable = &quot;false&quot; (com.apple.yellow.directtoweb.BooleanAssignment)</code><BR><BR>then the inspection button will once again show up in the list.<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Understand that we are still dealing with the very, very basics here and that we have just begun to scratch the surface of the flexibility offered by DirectToWeb. &nbsp;If you are not impressed with this simple example, please be patient. I want to lay a solid foundation that more complex articles can be built on later. &nbsp;As this is the first in what I hope will be many articles, I would appreciate any feedback you might have about layout and/or content of this article or suggestions for future articles.&nbsp;If you have any general questions about DirectToWeb Omni's webobjects-dev mailing list is a great resource.<BR><font FACE="Arial, Helvetica, sans-serif"><BR></font><FONT SIZE=2>Many thanks to Patrice Gautier who is an incredible teacher and if it wasn't for him I would still be approaching WebObjects design the &quot;old&quot; way. &nbsp;Also thanks to Patrice, Angela Muller and Travis Cripps for their valuable feedback.</FONT><font FACE="Arial, Helvetica, sans-serif"><BR></font></WEBOBJECT>