<?xml version="1.0"?>

<project name="Wonder" default="all" basedir="../..">
    <target name="usage" depends="global.properties">
	<echo>

There are many ways to use this script:

1) from the command line to build the whole of WONDER
		all    	--> create in ${build.root}
		install --> copy to ${wo.localroot}
		web     --> copy to ${wo.server.root}
		clean   --> remove .classes, .framework or .woa

2) to have clickable targets in PBX for specific parts of WONDER, for example
        ant -emacs -f ~/Wonder/Build/build/generic.xml \
            ERExtensions.$ACTION

3) to build your own projects that have the same layout as a wonder project
        ant -emacs -f ~/Wonder/Build/build/generic.xml  \
		-Dproject.type=application \
		-Dproject.name=SomeProject \
		-Dproject.principal.class=com.company.Application \
		-Dproject.dir=/path/to/my/SomeProject \
		-Duse.webobjects.d2w=true \
		-Duse.wonder.core=true \
		-Duse.wonder.d2w=true \
		-Duse.wonder.logic=true \
		-Duse.wonder.mail=true \
		-Duse.wonder.changenotification=true \
		-Duse.svgobjects=true \
		-Duse.validity=true \
		-Duse.woognl=true \
		-Duse.grouping=true \
		-Duse.reporting=true \
		-Duse.mysql=true \
		-Duse.additional.framework.[1-9]=SomePattern[1-9]\* \
		generic.MODE

    or shorter:
    
        ant -emacs -f ~/Wonder/Build/build/generic.xml  \
		-propertyfile=build.properties
                generic.MODE
    
    where "build.properties" is a file with the options above in
    java-property format. 

    Leave out any option you don't want. Valid entries MODEs are:

		all    	--> create in ${build.root}
		install --> copy to ${wo.localroot}
		web     --> copy to ${wo.server.root}
		clean   --> remove .classes, .framework or .woa

    For MODE "install", "clean" and "web" it is sufficient to call:

        ant -emacs -f ~/Wonder/Build/build/generic.xml  \
		-Dproject.type=application \
		-Dproject.name=SomeProject \
		generic.MODE
	</echo>
    </target>

    <!-- When you add another sub-project, use this as a template
         We strongly encourage you to use one of the provided 
         templates or mimic the structure
             SomeProject/
                Sources/
                Resources/
                WebServerResources/
                Components/
         when you create a new project.
         Additionally, you might want to add your subproject in the dependency hierachy
         and add it to the "all.web" "all.clean" and "all.install" tasks 
     -->

    <target name="SomeNewProject.all">
         <!-- project.type, either "global.application" or "global.framework" -->
         <antcall target="global.application.${build.action}" >

            <!-- princical class if the framework or Application class -->
            <param name="project.principal.class" value="com.company.Application" />

            <!-- Name of the framework or application -->
            <param name="project.name" value="SomeNewProject" />

            <!-- Path where the project resides, can be absolute -->
            <param name="project.dir" value="/path/to/your/project" />

            <!-- set this if you want to use plain D2W, or leave out if not -->
            <param name="use.webobjects.d2w" value="true" />

            <!-- set this if you want to use Wonders ERJars or leave out if not -->
            <param name="use.wonder.jars" value="true" />

            <!-- set this if you want to use Wonders ERJars and ERExtensions, or leave out if not -->
            <param name="use.wonder.core" value="true" />

            <!-- set this if you want to use Wonders D2W, or leave out if not -->
            <param name="use.wonder.d2w" value="true" />

            <!-- set this if you want to use Wonder's ERCoreBusinessLogic, or leave out if not -->
            <param name="use.wonder.logic" value="true" />

            <!-- set this if you want to use Wonder's ERJavaMail, or leave out if not -->
            <param name="use.wonder.mail" value="true" />

            <!-- set this if you want to use Wonder's ERIndexing, or leave out if not -->
            <param name="use.wonder.indexing" value="true" />

            <!-- set this if you want to use Wonder's ERChangeNotificationJMS, or leave out if not -->
            <param name="use.wonder.changenotification" value="true" />

            <!-- set this if you want to use Wonder's DynaGrouping, or leave out if not -->
            <param name="use.grouping" value="true" />

            <!-- set this if you want to use Wonder's DynaReporting, or leave out if not -->
            <param name="use.reporting" value="true" />

            <!-- set this if you want to use your own built frameworks, or leave out if not -->
            <!-- You have up to 9 of them and you can use patterns -->
            <param name="use.additional.framework.1" value="BTBusinessLogic.framework" />
            <param name="use.additional.framework.2" value="SomeOther*" />
            <param name="use.additional.framework.3" value="BT*" />
            <param name="use.additional.framework.4" value="BTBusinessLogic" />

            <!-- set this if you want to use SVGObjects, or leave out if not -->
            <param name="use.svgobjects" value="true" />

            <!-- set this if you want to use Validity, or leave out if not -->
            <param name="use.validity" value="true" />

            <!-- set this if you want to use WOOgnl, or leave out if not -->
            <param name="use.woognl" value="true" />

            <!-- set this if you want to use ExcelGenerator, or leave out if not -->
            <param name="use.excel" value="true" />

            <!-- set this if you want to use MySQL, or leave out if not -->
            <param name="use.mysql" value="true" />
        </antcall>
    </target>
    <!-- /When you add another sub-project, use this as a template -->

    <target name="generic">
        <antcall target="generic.all" />
    </target>
    <target name="generic.all">
        <antcall target="global.${project.type}" >
            <param name="project.principal.class" value="${project.principal.class}" />
            <param name="project.name" value="${project.name}" />
            <param name="project.dir" value="${project.dir}" />
        </antcall>
    </target>
    <target name="generic.clean">
        <antcall target="global.clean.${project.type}" >
            <param name="project.name" value="${project.name}" />
        </antcall>
    </target>
    <target name="generic.install">
        <antcall target="global.install.${project.type}" >
            <param name="project.name" value="${project.name}" />
        </antcall>
    </target>
    <target name="generic.web">
        <antcall target="global.web.${project.type}" >
            <param name="project.name" value="${project.name}" />
        </antcall>
    </target>
    
   <target name="global.environment">
        <property name="wonder.root" value="${basedir}" />
        <property file="${wonder.root}/Build/build/build.properties" />
        <property file="${user.home}/build.wonder.properties" />
        <property file="${user.home}/build.properties" />
        <property file="${wonder.root}/Build/build/default.properties" />
        <property file="${wonder.root}/Build/build/${os.name}.properties" />
        <property file="${wonder.root}/Build/build/default-os.properties" />

        <!-- default values. can be overridden by *.properties files or -D options. -->
        <property name="wo.woroot" value="/System" />
        <property name="wo.localroot" value="/" />
        <property name="wo.frameworks" value="${wo.woroot}/Library/Frameworks" />
        <property name="wo.local.frameworks" value="${wo.wolocalroot}/Library/Frameworks" />
        <property name="build.root" value="${user.home}/Roots" />
        <property name="build.classes" value="${build.root}/classes/${project.name}" />
        <property name="wonder.development" value="true" />
        
        <!-- if project.type is application and wonder.development is false, use installed frameworks, 
             otherwise use development frameworks. --> 
        <condition property="wonder.lib.root" value="${wo.localroot}/Library/Frameworks">
            <and>
                <equals arg1="${project.type}" arg2="application" />
                <isfalse value="${wonder.development}"/>
            </and>
        </condition>
        <property name="wonder.lib.root" value="${build.root}" />
    </target>

    <target name="global.properties" depends="global.environment">
        <property name="framework.name" value="${project.name}.framework" />
        <property name="build.framework.dir" value="${build.root}/${framework.name}" />
    </target>

    <target name="global.prepare" depends="global.properties">
        <path id="ant.classpath">
            <fileset dir="${wonder.root}/Build/">
                <include name="lib/*.jar"/>
            </fileset>
        </path>
        <mkdir dir="${project.dir}/Libraries" />
        <mkdir dir="${project.dir}/Sources" />
        <mkdir dir="${project.dir}/Resources" />
        <mkdir dir="${project.dir}/Components" />
        <mkdir dir="${project.dir}/WebServerResources" />
        <mkdir dir="${build.root}" />
        <mkdir dir="${build.classes}" />
    </target>

    <target name="dist.properties" depends="global.environment">
        <property name="project.source.dir" value="${wonder.root}/${project.dir}" />
    </target>

    <target name="global.framework.dist" depends="dist.properties">
        <property name="framework.name" value="${project.name}.framework" />

        <copy todir="${dist.dir}/Frameworks/${framework.name}">
            <fileset dir="${build.root}/${framework.name}" />
        </copy>

        <mkdir dir="${build.root}/${framework.name}/WebServerResources" />
        <copy todir="${dist.dir}/WebServerResources/Frameworks/${framework.name}" includeEmptyDirs="false">
            <fileset dir="${build.root}/${framework.name}/WebServerResources" />
        </copy>

        <mkdir dir="${project.source.dir}/Documentation" />
        <copy todir="${dist.dir}/Documentation/Frameworks/${framework.name}" includeEmptyDirs="false">
            <fileset dir="${project.source.dir}/Documentation">
                <exclude name="**/CVS/*" />
            </fileset>
        </copy>

        <mkdir dir="${project.source.dir}/Support" />
        <copy todir="${dist.dir}/Documentation/Frameworks/${framework.name}/Support" includeEmptyDirs="false">
            <fileset dir="${project.source.dir}/Support">
                <exclude name="**/CVS/*" />
            </fileset>
        </copy>
    </target>

    <target name="global.application.dist" depends="dist.properties">
        <property name="application.name" value="${project.name}.woa" />

        <copy todir="${dist.dir}/Applications/${application.name}">
            <fileset dir="${build.root}/${application.name}" />
        </copy>
        
        <chmod file="${dist.dir}/Applications/${application.name}/${project.name}" perm="ugo+rx"/>

        <mkdir dir="${build.root}/${application.name}/Contents/WebServerResources" />
        <copy todir="${dist.dir}/WebServerResources/${application.name}/Contents/WebServerResources" includeEmptyDirs="false">
            <fileset dir="${build.root}/${application.name}/Contents/WebServerResources" />
        </copy>

        <mkdir dir="${project.source.dir}/Documentation" />
        <copy todir="${dist.dir}/Documentation/Applications/${project}" includeEmptyDirs="false">
            <fileset dir="${project.source.dir}/Documentation">
                <exclude name="**/CVS/*" />
            </fileset>
        </copy>

        <mkdir dir="${project.source.dir}/Support" />
        <copy todir="${dist.dir}/Documentation/Applications/${project}/Support" includeEmptyDirs="false">
            <fileset dir="${project.source.dir}/Support">
                <exclude name="**/CVS/*" />
            </fileset>
        </copy>
    </target>

    <target name="global.compile" depends="global.environment,global.prepare">
         <taskdef name="wocompile" classname="org.objectstyle.woproject.ant.WOCompile">
            <classpath refid="ant.classpath"/>
        </taskdef>
        <echo message="${project.dir}/Sources" />
        <wocompile srcdir="${project.dir}/Sources" destdir="${build.classes}" debug="on" optimize="off" deprecation="on" source="${compiler.source}" target="${compiler.target}">
            <classpath>
                <fileset dir="${project.dir}/Libraries">
                    <include name="**/*.jar" />
                </fileset>
            </classpath>
           <frameworks dir="${wonder.lib.root}" if="wonder.lib.root.bundles" bundles="${wonder.lib.root.bundles}">
           </frameworks>
           <frameworks dir="${wo.frameworks}" if="wo.frameworks.bundles" bundles="${wo.frameworks.bundles}">
           </frameworks>
            <!-- this should be an exact copy of the frameworks in the woapplication task --> 
            <frameworks dir="${wonder.lib.root}" if="use.wonder.jars"> 
                <include name="ERJars.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.core"> 
                <include name="ERJars.framework" />
                <include name="ERExtensions.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.d2w"> 
                <include name="ERJars.framework" />
                <include name="ERExtensions.framework" />
                <include name="ERDirectToWeb.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.mail"> 
                <include name="ERJavaMail.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.indexing"> 
                <include name="ERIndexing.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.logic"> 
                <include name="ERCoreBusinessLogic.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.changenotification"> 
                <include name="ERChangeNotificationJMS.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.svgobjects"> 
                <include name="SVGObjects.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.validity"> 
                <include name="Validity.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.woognl"> 
                <include name="WOOgnl.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.excel"> 
                <include name="ExcelGenerator.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.grouping"> 
                <include name="DRGrouping.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.reporting"> 
                <include name="DRGrouping.framework" />
                <include name="WRReporting.framework" />
                <include name="WOOgnl.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.ajax"> 
                <include name="Ajax.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.yui">
                <include name="YUI.framework" />
            </frameworks> 
           <frameworks dir="${wo.localroot}/Library/Frameworks" if="use.reporting">
                <include name="WOComponentElements.framework"/>
           </frameworks>

           <frameworks dir="${wo.localroot}/Library/Frameworks" if="use.mysql">
                <include name="*PlugIn*.framework"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.1">
                <include name="${use.additional.framework.1}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.2">
                <include name="${use.additional.framework.2}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.3">
                <include name="${use.additional.framework.3}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.4">
                <include name="${use.additional.framework.4}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.5">
                <include name="${use.additional.framework.5}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.6">
                <include name="${use.additional.framework.6}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.7">
                <include name="${use.additional.framework.7}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.8">
                <include name="${use.additional.framework.8}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.9">
                <include name="${use.additional.framework.9}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.10">
                <include name="${use.additional.framework.10}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.11">
                <include name="${use.additional.framework.11}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.12">
                <include name="${use.additional.framework.12}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.13">
                <include name="${use.additional.framework.13}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.14">
                <include name="${use.additional.framework.14}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.15">
                <include name="${use.additional.framework.15}"/>
           </frameworks>
            <frameworks dir="${wo.frameworks}"> 
                <include name="JavaFoundation.framework" />
                <include name="JavaEOAccess.framework" />
                <include name="JavaEOControl.framework" />
                <include name="JavaWebObjects.framework" />
                <include name="JavaWOJSPServlet.framework" />
                <include name="JavaPlot.framework" />
                <include name="JavaJDBCAdaptor.framework" />
                <include name="JavaXML.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}"> 
                <include name="JavaWOExtensions.framework" />
            </frameworks>
            <frameworks dir="${wo.frameworks}" if="use.webobjects.d2w"> 
                <include name="JavaDirectToWeb.framework" />
                <include name="JavaEOProject.framework" />
                <include name="JavaDTWGeneration.framework" />
            </frameworks>
        </wocompile>
    </target>

    <target name="global.framework.build" depends="global.properties,global.compile">
        <mkdir dir="${build.framework.dir}" />
        <taskdef name="woframework" classname="org.objectstyle.woproject.ant.WOFramework">
            <classpath refid="ant.classpath"/>
        </taskdef>

        <woframework name="${project.name}" destDir="${build.root}" principalClass="${project.principal.class}" jarName="${project.name}">
            <lib dir="${project.dir}/Libraries">
                <include name="**/*.jar" />
            </lib>
            <classes dir="${build.classes}">
                <include name="**/*.class" />
            </classes>
            <sources dir="${project.dir}/Sources">
                <include name="**/*.java" />
            </sources>
            <resources dir="${project.dir}/Components">
                <include name="**.api" />
                <include name="**/*.wo/**" />
            </resources>
            <resources dir="${project.dir}/Resources">
                <include name="**/*" /> 
                <exclude name="*.*~/" />
            </resources>
            <wsresources dir="${project.dir}/WebServerResources">
                <include name="**/*" />
            </wsresources>
        </woframework>
 
        <echo message="-------------------------------------" />
        <echo message="${project.name}.framework done" />
        <echo message="-------------------------------------" />
    </target>

    <target name="global.application.build" depends="global.properties,global.compile" >

        <taskdef name="woapplication" classname="org.objectstyle.woproject.ant.WOApplication">
            <classpath refid="ant.classpath"/>
        </taskdef>

        <woapplication name="${project.name}" destDir="${build.root}" principalClass="${project.principal.class}" jarName="${project.name}" stdFrameworks="false">
            <classes dir="${build.classes}">
                <include name="**/*.class" />
            </classes>
            <lib dir="${project.dir}/Libraries">
                <include name="**/*.jar" />
            </lib>
            <resources dir="${project.dir}/Components">
                <include name="**.api" />
                <include name="**/*.wo/**" />
            </resources>
            <resources dir="${project.dir}/Resources">
                <include name="**/*" /> 
            </resources>
            <wsresources dir="${project.dir}/WebServerResources">
                <include name="**/*" />
            </wsresources>
            
            <!-- this should be an exact copy of the frameworks in the woapplication task --> 
           <frameworks dir="${wonder.lib.root}" if="wonder.lib.root.bundles" bundles="${wonder.lib.root.bundles}">
           </frameworks>
           <frameworks dir="${wo.frameworks}" if="wo.frameworks.bundles" bundles="${wo.frameworks.bundles}">
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.wonder.jars"> 
                <include name="ERJars.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.core"> 
                <include name="ERJars.framework" />
                <include name="ERExtensions.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.d2w"> 
                <include name="ERJars.framework" />
                <include name="ERExtensions.framework" />
                <include name="ERDirectToWeb.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.logic"> 
                <include name="ERPrototypes.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.logic"> 
                <include name="ERCoreBusinessLogic.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.mail"> 
                <include name="ERJavaMail.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.indexing"> 
                <include name="ERIndexing.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.wonder.changenotification"> 
                <include name="ERChangeNotificationJMS.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.svgobjects"> 
                <include name="SVGObjects.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.validity"> 
                <include name="Validity.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.woognl"> 
                <include name="WOOgnl.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.grouping"> 
                <include name="DRGrouping.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}" if="use.reporting"> 
                <include name="DRGrouping.framework" />
                <include name="WRReporting.framework" />
                <include name="WOOgnl.framework" />
            </frameworks>
           <frameworks dir="${wo.localroot}/Library/Frameworks" if="use.reporting">
                <include name="WOComponentElements.framework"/>
           </frameworks>
           <frameworks dir="${wo.localroot}/Library/Frameworks" if="use.movies">
                <include name="JavaBusinessLogic.framework"/>
           </frameworks>
            <frameworks dir="${wo.localroot}/Library/Frameworks" if="use.mysql">
                <include name="*PlugIn.framework"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.1">
                <include name="${use.additional.framework.1}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.2">
                <include name="${use.additional.framework.2}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.3">
                <include name="${use.additional.framework.3}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.4">
                <include name="${use.additional.framework.4}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.5">
                <include name="${use.additional.framework.5}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.6">
                <include name="${use.additional.framework.6}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.7">
                <include name="${use.additional.framework.7}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.8">
                <include name="${use.additional.framework.8}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.9">
                <include name="${use.additional.framework.9}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.10">
                <include name="${use.additional.framework.10}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.11">
                <include name="${use.additional.framework.11}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.12">
                <include name="${use.additional.framework.12}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.13">
                <include name="${use.additional.framework.13}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.14">
                <include name="${use.additional.framework.14}"/>
           </frameworks>
           <frameworks dir="${wonder.lib.root}" if="use.additional.framework.15">
                <include name="${use.additional.framework.15}"/>
           </frameworks>
           <frameworks dir="${wo.woroot}/Library/Frameworks"> 
                <include name="JavaFoundation.framework" />
                <include name="JavaEOAccess.framework" />
                <include name="JavaEOControl.framework" />
                <include name="JavaWebObjects.framework" />
                <include name="JavaWOJSPServlet.framework" />
                <include name="JavaPlot.framework" />
                <include name="JavaJDBCAdaptor.framework" />
                <include name="JavaXML.framework" />
            </frameworks>
            <frameworks dir="${wonder.lib.root}"> 
                <include name="JavaWOExtensions.framework" />
            </frameworks>
            <frameworks dir="${wo.woroot}/Library/Frameworks" if="use.webobjects.webservices.server"> 
                <include name="JavaWebServices*.framework" />
            </frameworks>
            <frameworks dir="${wo.woroot}/Library/Frameworks" if="use.webobjects.d2w"> 
                <include name="JavaDirectToWeb.framework" />
                <include name="JavaEOProject.framework" />
                <include name="JavaDTWGeneration.framework" />
            </frameworks>
        </woapplication>
        <exec dir="${build.root}/${project.name}.woa" executable="/bin/chmod" os="Mac OS X">
            <arg line="a+x ${project.name}" />
        </exec>
        <exec dir="${build.root}/${project.name}.woa/Contents/MacOS" executable="/bin/chmod" os="Mac OS X">
            <arg line="a+x ${project.name}" />
        </exec>

        <echo message="-------------------------------------" />
        <echo message="${project.name}.woa" />
        <echo message="-------------------------------------" />
    </target>

    <target name="global.framework.install" depends="global.properties">
        <copy todir="${wo.localroot}/Library/Frameworks/${project.name}.framework">
            <fileset dir="${build.root}/${project.name}.framework" />
        </copy>
    </target>

    <target name="global.application.install" depends="global.properties">
         <mkdir dir="${wo.localroot}/Library/WebObjects/JavaApplications" />
         <copy todir="${wo.localroot}/Library/WebObjects/JavaApplications/${project.name}.woa">
            <fileset dir="${build.root}/${project.name}.woa" />
        </copy>
        <exec dir="${wo.localroot}/Library/WebObjects/JavaApplications/${project.name}.woa" executable="/bin/chmod" os="Mac OS X">
            <arg line="a+x ${project.name}" />
        </exec>
    </target>

    <target name="global.framework.web" depends="global.properties">
        <mkdir dir="${wo.server.root}/Frameworks/${project.name}.framework" />
        <copy todir="${wo.server.root}/Frameworks/${project.name}.framework/WebServerResources">
            <fileset dir="${build.root}/${project.name}.framework/WebServerResources" />
        </copy>
    </target>
	
    <target name="global.application.web" depends="global.properties">
        <mkdir dir="${wo.server.root}/${project.name}.woa" />
        <mkdir dir="${wo.server.root}/${project.name}.woa/Contents" />
        <copy todir="${wo.server.root}/${project.name}.woa/Contents/WebServerResources">
            <fileset dir="${build.root}/${project.name}.woa/Contents/WebServerResources" />
        </copy>
    </target>
	
    <target name="global.framework.clean" depends="global.properties">
        <delete dir="${build.classes}" />
        <delete dir="${build.root}/${project.name}.framework" />
    </target>
	
    <target name="global.application.clean" depends="global.properties">
        <delete dir="${build.classes}" />
        <delete dir="${build.root}/${project.name}.woa" />
    </target>


    <!-- (ak) ERJars is handled separately because it needs to copy the compiler proxy files first -->
    <target name="ERJars.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="ERJars" />
            <param name="project.dir" value="Common/Frameworks/ERJars" />
        </antcall>
    </target>
   
    <target name="JavaWOExtensions.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="JavaWOExtensions" />
            <param name="project.dir" value="Common/Frameworks/JavaWOExtensions" />
        </antcall>
    </target>

    <target name="ERExtensions.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="er.extensions.ERXExtensions" />
            <param name="project.name" value="ERExtensions" />
            <param name="project.dir" value="Common/Frameworks/ERExtensions" />

            <param name="use.wonder.core" value="true" />
        </antcall>
    </target>
    
    <target name="ERDirectToWeb.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="er.directtoweb.ERDirectToWeb" />
            <param name="project.name" value="ERDirectToWeb" />
            <param name="project.dir" value="Common/Frameworks/ERDirectToWeb" />

            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.d2w" value="true" />
            <param name="use.wonder.logic" value="true" />
        </antcall>
    </target>
    
    <target name="ERPrototypes.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="er.prototypes.ERPrototypes" />
            <param name="project.name" value="ERPrototypes" />
            <param name="project.dir" value="Common/Frameworks/ERPrototypes" />

            <param name="use.wonder.core" value="true" />
        </antcall>
    </target>

    <target name="ERJavaMail.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="er.javamail.ERJavaMail" />
            <param name="project.name" value="ERJavaMail" />
            <param name="project.dir" value="Common/Frameworks/ERJavaMail" />
            <param name="use.wonder.core" value="true" />
       </antcall>
    </target>

    <target name="ERIndexing.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="ERIndexing" />
            <param name="project.dir" value="Common/Frameworks/ERIndexing" />
            <param name="use.wonder.core" value="true" />
       </antcall>
    </target>
    
    <target name="ERPlot.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="er.plot.ERPlot" />
            <param name="project.name" value="ERPlot" />
            <param name="project.dir" value="Common/Frameworks/ERPlot" />
            <param name="use.wonder.core" value="true" />
       </antcall>
    </target>
    
    <target name="ERExcelLook.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="er.directtoweb.excel.ERExcelLook" />
            <param name="project.name" value="ERExcelLook" />
            <param name="project.dir" value="Common/Frameworks/ERExcelLook" />
            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.d2w" value="true" />
       </antcall>
    </target>
    
    <target name="ERCoreBusinessLogic.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="er.corebusinesslogic.ERCoreBusinessLogic" />
            <param name="project.name" value="ERCoreBusinessLogic" />
            <param name="project.dir" value="Common/Frameworks/ERCoreBusinessLogic" />

            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.mail" value="true" />
            <param name="use.wonder.d2w" value="true" />
        </antcall>
    </target>
    
    <target name="ERChangeNotificationJMS.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="er.changenotification.ERCNNotificationCoordinator" />
            <param name="project.name" value="ERChangeNotificationJMS" />
            <param name="project.dir" value="Common/Frameworks/ERChangeNotificationJMS" />
            <param name="use.wonder.core" value="true" />
        </antcall>
    </target>

    <target name="ERNeutralLook.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="ERNeutralLook" />
            <param name="project.dir" value="Common/Frameworks/ERNeutralLook" />

            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.d2w" value="true" />
            <param name="use.wonder.logic" value="true" />
        </antcall>
    </target>
    
    <target name="WOOgnl.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="ognl.webobjects.WOOgnl" />
            <param name="project.name" value="WOOgnl" />
            <param name="project.dir" value="Common/Frameworks/WOOgnl" />

            <param name="use.wonder.jars" value="true" />
            <param name="use.webobjects.d2w" value="true" />
        </antcall>
    </target>

    <target name="BTBusinessLogic.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="er.bugtracker.BTBusinessLogic" />
            <param name="project.name" value="BTBusinessLogic" />
            <param name="project.dir" value="Common/Applications/BugTracker/Frameworks/BTBusinessLogic" />

            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.d2w" value="true" />
            <param name="use.wonder.logic" value="true" />
        </antcall>
    </target>

    <target name="BugTracker.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="er.bugtracker.Application" />
            <param name="project.name" value="BugTracker" />
            <param name="project.dir" value="Common/Applications/BugTracker" />

            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.d2w" value="true" />
            <param name="use.wonder.logic" value="true" />
            <param name="use.woognl" value="true" />
            <param name="use.mysql" value="true" />
            <param name="use.additional.framework.1" value="BTBusinessLogic.framework" />
            <param name="use.additional.framework.2" value="C9Extensions.framework" />
        </antcall>
    </target>

    <target name="ERMailer.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="er.javamail.mailer.Application" />
            <param name="project.name" value="ERMailer" />
            <param name="project.dir" value="Common/Applications/ERMailer" />
 
            <param name="use.wonder.core" value="true" />
            <param name="use.wonder.logic" value="true" />
            <param name="use.wonder.mail" value="true" />
       </antcall>
    </target>

    <target name="D2WInspectExample.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="Application" />
            <param name="project.name" value="D2WInspectExample" />
            <param name="project.dir" value="Common/Examples/Stepwise/D2WInspectExample" />
 
            <param name="use.webobjects.d2w" value="true" />
       </antcall>
    </target>

    <target name="ERMovies.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="er.examples.movies.Application" />
            <param name="project.name" value="ERMovies" />
            <param name="project.dir" value="Common/Examples/ERMovies" />
 
            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.d2w" value="true" />
            <param name="use.movies" value="true" />
       </antcall>
    </target>

    <target name="D2WListExample.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="Application" />
            <param name="project.name" value="D2WListExample" />
            <param name="project.dir" value="Common/Examples/Stepwise/D2WListExample" />
            <param name="use.webobjects.d2w" value="true" />
         </antcall>
    </target>

    <target name="D2WComponentTour.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="Application" />
            <param name="project.name" value="D2WComponentTour" />
            <param name="project.dir" value="Common/Examples/D2WComponentTour" />

            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.d2w" value="true" />
         </antcall>
    </target>

    <target name="NetStruxrCaseStudy.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="Application" />
            <param name="project.name" value="NetStruxrCaseStudy" />
            <param name="project.dir" value="Common/Examples/Wrox/NetStruxrCaseStudy" />

            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.d2w" value="true" />
            <param name="use.wonder.logic" value="true" />
        </antcall>
    </target>
    
    <target name="ERMiniUglyLook.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="ERMiniUglyLook" />
            <param name="project.dir" value="Common/Examples/Wrox/ERMiniUglyLook" />

            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.d2w" value="true" />
        </antcall>
    </target>
    
    <target name="WOPayPal.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="er.wopaypal.WOPayPal" />
            <param name="project.name" value="WOPayPal" />
            <param name="project.dir" value="PayPal/Frameworks/WOPayPal" />
        </antcall>
    </target>

    <target name="DRGrouping.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="DRGrouping" />
            <param name="project.dir" value="DynaReporting/Frameworks/DRGrouping" />
            <param name="use.wonder.core" value="true" />
            <param name="use.woognl" value="true" />
        </antcall>
    </target>

    <target name="WRReporting.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="WRReporting" />
            <param name="project.dir" value="DynaReporting/Frameworks/WRReporting" />
            <param name="use.wonder.core" value="true" />
            <param name="use.woognl" value="true" />
            <param name="use.reporting" value="true" />
        </antcall>
    </target>

    <target name="DocsByExample.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="er.reporting.examples.Application" />
            <param name="project.name" value="DocsByExample" />
            <param name="project.dir" value="DynaReporting/Examples/DocsByExample" />

            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.core" value="true" />
            <param name="use.reporting" value="true" />
            <param name="use.mysql" value="true" />
            <param name="use.movies" value="true" />
        </antcall>
    </target>

    <target name="DynaReporter.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="er.reporting.examples.Application" />
            <param name="project.name" value="DynaReporter" />
            <param name="project.dir" value="DynaReporting/Examples/DynaReporter" />

            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.core" value="true" />
            <param name="use.reporting" value="true" />
            <param name="use.mysql" value="true" />
            <param name="use.movies" value="true" />
        </antcall>
    </target>

    <target name="DRGroupingTest.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="er.grouping.examples.Application" />
            <param name="project.name" value="DRGroupingTest" />
            <param name="project.dir" value="DynaReporting/Examples/DRGroupingTest" />

            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.core" value="true" />
            <param name="use.grouping" value="true" />
            <param name="use.mysql" value="true" />
            <param name="use.movies" value="true" />
        </antcall>
    </target>

    <target name="Validity.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="Validity" />
            <param name="project.dir" value="Validity/Frameworks/Validity" />
        </antcall>
    </target>
    
    <target name="specific.validity.application" depends="global.properties">
        <!--antcall target="global.application.${build.action}" />
            <move todir="${build.root}/${project.name}.woa/Contents/WebServerResources" flatten="true" includeEmptyDirs="no">
            <fileset dir="${build.root}/${project.name}.woa/Contents/WebServerResources" />
        </move-->
    </target>

    <target name="ValidityModeler.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="" />
            <param name="project.name" value="ValidityModeler" />
            <param name="project.dir" value="Validity/Applications/ValidityModeler" />

            <param name="use.validity" value="true" />
        </antcall>
    </target>

    <target name="ValidityExample.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="" />
            <param name="project.name" value="ValidityExample" />
            <param name="project.dir" value="Validity/Examples/ValidityExample" />

            <param name="use.validity" value="true" />
        </antcall>
    </target>
	
    <target name="SVGObjects.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="SVGObjects" />
            <param name="project.dir" value="SVGObjects/Frameworks/SVGObjects" />
        </antcall>
    </target>

    <target name="SVGObjects.ComponentTour.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="org.svgobjects.examples.componenttour.Application" />
            <param name="project.name" value="SVGObjectsComponentTour" />
            <param name="project.dir" value="SVGObjects/Examples/ComponentTour" />

            <param name="use.svgobjects" value="true" />
        </antcall>
    </target>
	
    <target name="SVGObjects.eCards.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="org.svgobjects.examples.ecard.Application" />
            <param name="project.name" value="SVGObjectsECards" />
            <param name="project.dir" value="SVGObjects/Examples/eCards" />

            <param name="use.svgobjects" value="true" />
        </antcall>
    </target>
	
    <target name="SVGObjects.EZForms.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="org.svgobjects.examples.ezforms.Application" />
            <param name="project.name" value="SVGObjectsEZForms" />
            <param name="project.dir" value="SVGObjects/Examples/EZForms" />

            <param name="use.svgobjects" value="true" />
        </antcall>
    </target>
	
    <target name="SVGObjects.Hello.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="org.svgobjects.examples.hello.Application" />
            <param name="project.name" value="SVGObjectsHello" />
            <param name="project.dir" value="SVGObjects/Examples/Hello" />

            <param name="use.svgobjects" value="true" />
        </antcall>
    </target>
	
    <target name="SVGObjects.PopIdol.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="org.svgobjects.examples.popidol.Application" />
            <param name="project.name" value="SVGObjectsPopIdol" />
            <param name="project.dir" value="SVGObjects/Examples/PopIdol" />

            <param name="use.svgobjects" value="true" />
        </antcall>
    </target>
	
    <target name="DevStudio.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="ag.kcmedia.Application" />
            <param name="project.name" value="DevStudio" />
            <param name="project.dir" value="Experimental/DevStudio" />

            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.d2w" value="true" />
         </antcall>
    </target>

    <target name="ERCalendar.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="ERCalendar" />
            <param name="project.dir" value="Common/Frameworks/ERCalendar" />
        </antcall>
    </target>

    <target name="EGSampleApp.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="er.excel.Application" />
            <param name="project.name" value="EGSampleApp" />
            <param name="project.dir" value="ExcelGeneration/Examples/EGSampleApp" />
	    <param name="use.additional.framework.1" value="ExcelGenerator.framework" />
            <param name="use.wonder.core" value="true" />
        </antcall>
    </target>
    <target name="ExcelGenerator.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="ExcelGenerator" />
            <param name="project.dir" value="ExcelGeneration/Frameworks/ExcelGenerator" />

            <param name="use.wonder.core" value="true" />
        </antcall>
    </target>
    <target name="AjaxExample.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="Application" />
            <param name="project.name" value="AjaxExample" />
            <param name="project.dir" value="Ajax/AjaxExample" />
	        <param name="use.additional.framework.1" value="Ajax.framework" />
            <param name="use.wonder.core" value="true" />
            <param name="use.wonder.ajax" value="true" />
        </antcall>
    </target>
    <target name="Ajax.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="er.ajax.Ajax" />
            <param name="project.name" value="Ajax" />
            <param name="project.dir" value="Ajax/Ajax" />

            <param name="use.wonder.core" value="true" />
        </antcall>
    </target>
    <target name="YUIExample.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="Application" />
            <param name="project.name" value="YUIExample" />
            <param name="project.dir" value="Ajax/YUIExample" />
      		<param name="use.additional.framework.1" value="Ajax.framework" />
      		<param name="use.additional.framework.2" value="YUI.framework" />
            <param name="use.wonder.core" value="true" />
            <param name="use.wonder.ajax" value="true" />
            <param name="use.wonder.yui" value="true" />
        </antcall>
    </target>
    <target name="YUI.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="YUI" />
            <param name="project.dir" value="Ajax/YUI" />
            <param name="use.additional.framework.1" value="Ajax.framework" />
            <param name="use.wonder.core" value="true" />
            <param name="use.wonder.ajax" value="true" />
        </antcall>
    </target>
    
    <target name="AjaxLookExample.all">
        <antcall target="global.application.${build.action}" >
            <param name="project.type" value="application" />
            <param name="project.principal.class" value="Application" />
            <param name="project.name" value="AjaxLookExample" />
            <param name="project.dir" value="Ajax/AjaxLookExample" />
      		<param name="use.additional.framework.1" value="Ajax.framework" />
      		<param name="use.additional.framework.2" value="YUI.framework" />
      		<param name="use.additional.framework.3" value="AjaxLook.framework" />
            <param name="use.wonder.core" value="true" />
            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.d2w" value="true" />
            <param name="use.wonder.ajax" value="true" />
            <param name="use.wonder.yui" value="true" />
        </antcall>
    </target>
    <target name="AjaxLook.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="AjaxLook" />
            <param name="project.dir" value="Ajax/AjaxLook" />
      		<param name="use.additional.framework.1" value="Ajax.framework" />
      		<param name="use.additional.framework.2" value="YUI.framework" />
            <param name="use.wonder.core" value="true" />
            <param name="use.wonder.d2w" value="true" />
            <param name="use.webobjects.d2w" value="true" />
            <param name="use.wonder.ajax" value="true" />
        </antcall>
    </target>

    <target name="ERIMAdaptor.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="ERIMAdaptor" />
            <param name="project.dir" value="WOAdaptors/ERIMAdaptor" />
	    <param name = "compiler.target" value = "1.5" />
	    <param name = "compiler.source" value = "1.5" />

            <param name="use.wonder.core" value="true" />
        </antcall>
    </target>
    <target name="ERWorkerChannel.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="" />
            <param name="project.name" value="ERWorkerChannel" />
            <param name="project.dir" value="Common/Frameworks/ERWorkerChannel" />

            <param name="use.wonder.core" value="true" />
        </antcall>
    </target>
    <target name="PostgresqlPlugIn.all">
        <antcall target="global.framework.${build.action}" >
            <param name="project.principal.class" value="com.webobjects.jdbcadaptor.PostgresqlPlugIn" />
            <param name="project.name" value="PostgresqlPlugIn" />
            <param name="project.dir" value="PlugIns/PostgresqlPlugIn" />
        </antcall>
    </target>
    

    <target name="common.frameworks.all" depends="ERJars.all, JavaWOExtensions.all, ERExtensions.all, ERDirectToWeb.all, ERNeutralLook.all, WOOgnl.all, ERPrototypes.all, ERPlot.all, ERIndexing.all, ERJavaMail.all, ERCoreBusinessLogic.all, ERChangeNotificationJMS.all, ERCalendar.all, ERExcelLook.all, ERWorkerChannel.all, BTBusinessLogic.all, ERMiniUglyLook.all" />
    
    <target name="common.applications.all" depends="BugTracker.all, ERMailer.all" />

    <target name="common.examples.all" depends="ERMiniUglyLook.all, NetStruxrCaseStudy.all, D2WListExample.all, D2WInspectExample.all, ERMovies.all, D2WComponentTour.all, AjaxExample.all, YUIExample.all" />
    
    <target name="dynareporting.frameworks.all" depends="DRGrouping.all, WRReporting.all" />
    <target name="dynareporting.examples.all" depends="DocsByExample.all, DynaReporter.all, DRGroupingTest.all" />
    
    <target name="excelgeneration.frameworks.all" depends="ExcelGenerator.all" />
    <target name="excelgeneration.examples.all" depends="EGSampleApp.all" />
    
    <target name="ajax.frameworks.all" depends="Ajax.all, YUI.all, AjaxLook.all" />
    <target name="ajax.examples.all" depends="AjaxExample.all, YUIExample.all, AjaxLookExample.all" />
    
    <target name="plugins.all" depends="PostgresqlPlugIn.all" />

    <target name="validity.frameworks.all" depends="Validity.all" />
    <target name="validity.applications.all" depends="ValidityModeler.all" />
    <target name="validity.examples.all" depends="ValidityExample.all" />

    <target name="svgobjects.frameworks.all" depends="SVGObjects.all" />
    <target name="svgobjects.examples.all" depends="SVGObjects.ComponentTour.all, SVGObjects.eCards.all, SVGObjects.EZForms.all, SVGObjects.Hello.all, SVGObjects.PopIdol.all" />

    <target name="paypal.frameworks.all" depends="WOPayPal.all" />
    <target name="woadaptors.all" depends="ERIMAdaptor.all" />
    <target name="experimental.all" depends="DevStudio.all" />
    
    <target name="frameworks.all" depends="common.frameworks.all, excelgeneration.frameworks.all, ajax.frameworks.all, woadaptors.all, validity.frameworks.all, svgobjects.frameworks.all, plugins.all, paypal.frameworks.all, dynareporting.frameworks.all, woadaptors.all"/>
    <target name="applications.all" depends="DevStudio.all, common.applications.all, validity.applications.all"/>
    <target name="examples.all" depends="common.examples.all, excelgeneration.examples.all, validity.examples.all, dynareporting.examples.all, ajax.examples.all, experimental.all"/>


    <target name="all.run" depends="frameworks.all, applications.all, examples.all"/>
    
    <target name="build">
        <antcall target="all.run" >
            <param name="build.action" value="build" />
        </antcall>
    </target>

    <target name="dist">
    
        <antcall target="all.run" >
            <param name="dist.base" value="${dist.base}" />
            <param name="project.version" value="${project.version}" />
            <param name="dist.dir" value="${dist.base}/Wonder-${project.version}"/>
            <param name="build.action" value="dist" />
        </antcall>

        <copy todir="${dist.base}/Wonder-src-${project.version}" 
                includeEmptyDirs="false" preservelastmodified="true">
            <fileset dir=".">
                <exclude name="**/CVS/*" />
             	<exclude name="**/dist/**"/>
             	<exclude name="**/bin/**"/>
             	<exclude name="**/build/**"/>
             	<exclude name="**/target/**"/>
            </fileset>
        </copy>
        
        <tar tarfile="${dist.base}/Wonder-src-${project.version}.tar" longfile="gnu">
            <tarfileset dir="${dist.base}/Wonder-src-${project.version}">
            </tarfileset>
        </tar>

        <gzip src="${dist.base}/Wonder-src-${project.version}.tar" 
            zipfile="${dist.base}/Wonder-src-${project.version}.tgz"/>

        <delete file="${dist.base}/Wonder-src-${project.version}.tar"/>
        <zip destfile="${dist.base}/Wonder-${project.version}.zip" 
            basedir="${dist.base}/Wonder-${project.version}"
            excludes="**/CVS/*, **/dist/**" />
    </target>

    <target name="install">
        <antcall target="all.run" >
            <param name="build.action" value="install" />
        </antcall>
    </target>
    
    <target name="web">
        <antcall target="all.run" >
            <param name="build.action" value="web" />
        </antcall>
    </target>
    
    <target name="clean">
        <antcall target="all.run" >
            <param name="build.action" value="clean" />
        </antcall>
    </target>
    
    <target name="all" depends="build, install, web" />
</project>
