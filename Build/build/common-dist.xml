<project name="common" default="all" basedir="../..">

    <target name="framework.properties">
        <property name="dist" value="${dist.base}/${project.name}-${project.version}"/>
        <property name="build.root" value="${user.home}/Roots" />
        <property name="project.source.dir" value="${wonder.root}/${project.dir}" />
    </target>

    <target name="copy.framework" depends="framework.properties">
        <property name="framework.name" value="${project}.framework" />

        <copy todir="${dist}/Frameworks/${framework.name}">
            <fileset dir="${build.root}/${framework.name}" />
        </copy>

        <copy todir="${dist}/WebServerResources/Frameworks/${framework.name}">
            <fileset dir="${build.root}/${framework.name}/WebServerResources" />
        </copy>

        <copy todir="${dist}/Documentation/Frameworks/${framework.name}">
            <fileset dir="${project.source.dir}/Documentation">
                <exclude name="**/CVS/**" />
            </fileset>
        </copy>

        <copy todir="${dist}/Documentation/Frameworks/${framework.name}/Support">
            <fileset dir="${project.source.dir}/Support">
                <exclude name="**/CVS/**" />
            </fileset>
        </copy>

        <echo message="-------------------------------------" />
        <echo message="${framework.name}" />
        <echo message="-------------------------------------" />
    </target>


    <target name="application.properties">
        <property name="dist" value="${dist.base}/${project.name}-${project.version}"/>
        <property name="build.root" value="${user.home}/Roots" />
        <property name="project.source.dir" value="${wonder.root}/${project.dir}" />
    </target>

    <target name="copy.application" depends="application.properties">
        <property name="application.name" value="${project}.woa" />

        <copy todir="${dist}/Applications/${application.name}">
            <fileset dir="${build.root}/${application.name}" />
        </copy>

        <copy todir="${dist}/WebServerResources/${application.name}/Contents/WebServerResources">
            <fileset dir="${build.root}/${application.name}/Contents/WebServerResources" />
        </copy>

        <copy todir="${dist}/Documentation/Applications/${project}">
            <fileset dir="${project.source.dir}/Documentation">
                <exclude name="**/CVS/**" />
            </fileset>
        </copy>

        <copy todir="${dist}/Documentation/Applications/${project}/Support">
            <fileset dir="${project.source.dir}/Support">
                <exclude name="**/CVS/**" />
            </fileset>
        </copy>

        <echo message="-------------------------------------" />
        <echo message="${application.name}" />
        <echo message="-------------------------------------" />
    </target>


    <!-- ERJars -->
    <target name="ERJars.all">
        <antcall target="copy.framework" >
            <param name="project" value="ERJars" />
            <param name="project.dir" value="Common/Frameworks/ERJars" />
        </antcall>
    </target>
	
    <!-- JavaWOExtensions -->
    <target name="JavaWOExtensions.all">
        <antcall target="copy.framework" >
            <param name="project" value="JavaWOExtensions" />
            <param name="project.dir" value="Common/Frameworks/JavaWOExtensions" />
        </antcall>
    </target>

    <!-- ERExtensions -->
    <target name="ERExtensions.all">
        <antcall target="copy.framework" >
            <param name="project" value="ERExtensions" />
            <param name="project.dir" value="Common/Frameworks/ERExtensions" />
        </antcall>
    </target>
	
    <!-- ERDirectToWeb -->
    <target name="ERDirectToWeb.all">
        <antcall target="copy.framework" >
            <param name="project" value="ERDirectToWeb" />
            <param name="project.dir" value="Common/Frameworks/ERDirectToWeb" />
        </antcall>
    </target>
	
    <!-- ERCoreBusinessLogic -->
    <target name="ERCoreBusinessLogic.all">
        <antcall target="copy.framework" >
            <param name="project" value="ERCoreBusinessLogic" />
            <param name="project.dir" value="Common/Frameworks/ERCoreBusinessLogic" />
        </antcall>
    </target>
	
    <!-- ERJavaMail -->
    <target name="ERJavaMail.all">
        <antcall target="copy.framework" >
            <param name="project" value="ERJavaMail" />
            <param name="project.dir" value="Common/Frameworks/ERJavaMail" />
        </antcall>
    </target>

    <!-- ERChangeNotificationJMS -->
    <target name="ERChangeNotificationJMS.all">
        <antcall target="copy.framework" >
            <param name="project" value="ERChangeNotificationJMS" />
            <param name="project.dir" value="Common/Frameworks/ERChangeNotificationJMS" />
        </antcall>
    </target>
	
    <!-- ERNeutralLook -->
    <target name="ERNeutralLook.all">
        <antcall target="copy.framework" >
            <param name="project" value="ERNeutralLook" />
            <param name="project.dir" value="Common/Frameworks/ERNeutralLook" />
        </antcall>
    </target>
	
    <!-- WOOgnl -->
    <target name="WOOgnl.all">
        <antcall target="copy.framework" >
            <param name="project" value="WOOgnl" />
            <param name="project.dir" value="Common/Frameworks/WOOgnl" />
        </antcall>
    </target>

    <!-- BTBusinessLogic -->
    <target name="BTBusinessLogic.all">
        <antcall target="copy.framework" >
            <param name="project" value="BTBusinessLogic" />
            <param name="project.dir" value="Common/Applications/BugTracker/Frameworks/BTBusinessLogic" />
        </antcall>
    </target>

    <!-- BugTracker -->
    <target name="BugTracker.all">
        <antcall target="copy.application" >
            <param name="project" value="BugTracker" />
            <param name="project.dir" value="Common/Applications/BugTracker" />
        </antcall>
    </target>

    <!-- D2WInspectExample -->
    <target name="D2WInspectExample.all">
        <antcall target="copy.application" >
            <param name="project" value="D2WInspectExample" />
            <param name="project.dir" value="Common/Examples/Stepwise/D2WInspectExample" />
        </antcall>
    </target>

    <!-- D2WListExample -->
    <target name="D2WListExample.all">
        <antcall target="copy.application" >
            <param name="project" value="D2WListExample" />
            <param name="project.dir" value="Common/Examples/Stepwise/D2WListExample" />
        </antcall>
    </target>

    <!-- NetStruxrCaseStudy -->
    <target name="NetStruxrCaseStudy.all">
        <antcall target="copy.application" >
            <param name="project" value="NetStruxrCaseStudy" />
            <param name="project.dir" value="Common/Examples/Wrox/NetStruxrCaseStudy" />
        </antcall>
    </target>
	
    <!-- ERMiniUglyLook -->
    <target name="ERMiniUglyLook.all">
        <antcall target="copy.framework" >
            <param name="project" value="ERMiniUglyLook" />
            <param name="project.dir" value="Common/Examples/Wrox/ERMiniUglyLook" />
        </antcall>
    </target>

	
    <target name="core.all" depends="ERJars.all, JavaWOExtensions.all, ERExtensions.all, ERDirectToWeb.all" />
    <target name="frameworks.all" depends="core.all, ERNeutralLook.all, WOOgnl.all, ERCoreBusinessLogic.all, ERJavaMail.all, ERChangeNotificationJMS.all" />

    <target name="bugtracker.all" depends="frameworks.all, BTBusinessLogic.all, BugTracker.all" />
    <target name="applications.all" depends="frameworks.all, bugtracker.all" />

    <target name="wrox.all" depends="frameworks.all, ERMiniUglyLook.all, NetStruxrCaseStudy.all" />
    <target name="stepwise.all" depends="D2WListExample.all, D2WInspectExample.all" />
    <target name="examples.all" depends="frameworks.all, wrox.all, stepwise.all" />

    <target name="dist.prebuilt" depends="frameworks.all, applications.all, examples.all" />

    <!-- ==================================================== -->
    <!-- Create Wonder Source Destribution.                   -->
    <!-- ==================================================== -->
    <target name="dist.source">
        <copy todir="${dist.base}/${project.name}-src-${project.version}">
            <fileset dir="${wonder.root}">
                <exclude name="**/CVS/**" />
             	<exclude name="**/dist/**"/> 
            </fileset>
        </copy>
        
        <!-- <tar tarfile="${dist.base}/${project.name}-src-${project.version}.tar">
            <tarfileset dir="${wonder.root}">
                <exclude name="**/CVS/**" />
             	<exclude name="**/dist/**"/>
            </tarfileset>
        </tar>

        <gzip src="$${dist.base}/${project.name}-src-${project.version}.tar" 
            zipfile="${dist.base}/${project.name}-src-${project.version}.tar.gz"/>

        <delete file="${dist.base}/${project.name}-src-${project.version}.tar"/> -->
    </target>


    <target name="all" depends="dist.prebuilt, dist.source" />
	
</project>
