<?xml version="1.0"?>

<!-- ======================================================== -->
<!--     WONDER Documentation and website Ant build file      -->
<!--                                                          -->
<!-- Called from "build.xml", normally shouldn't be used as   --> 
<!-- a standalone buildfile.                                  -->
<!-- ======================================================== -->
<project name="wonder-doc" default="doc" basedir="../..">

    <!-- ==================================================== -->
    <!--              CLASSPATH settings                      -->
    <!-- ==================================================== -->
    <path id="classpath">
        <fileset dir="Build/lib">
            <include name="cayenne.jar"/>
            <include name="jdom*.jar"/>
        </fileset>
    </path>
    
    <!-- ==================================================== -->
    <!-- Sets up distribution directories.                    -->
    <!-- ==================================================== -->
    <target name="prepare">
        <mkdir dir="${dist}"/>
        <mkdir dir="${dist}/doc"/>
        <mkdir dir="${dist}/doc/api"/>
    </target>


    <!-- ==================================================== -->
    <!-- Clean Wonder                                         -->
    <!-- ==================================================== -->
    <target name="clean">
        <delete dir="${dist}/doc"/>
    </target>


    <!-- ==================================================== -->
    <!-- Build Wonder documenatation.                         -->
    <!-- ==================================================== -->
    <target name="doc" depends="prepare">
        <taskdef name="anakia" classname="org.apache.velocity.anakia.AnakiaTask">
            <classpath refid="classpath"/>
        </taskdef>

        <!-- Build site -->
        <anakia basedir="Build/xdocs" destdir="${dist}/doc"
             extension=".html" style="wonder.vsl"
             projectFile="stylesheets/project.xml"
             excludes="**/stylesheets/**"
             includes="**/*.xml"
             lastModifiedCheck="true"
             templatePath="Build/xdocs/stylesheets">
        </anakia>

        <!-- copy resources -->
        <copy todir="${dist}/doc" filtering="no">
            <fileset dir="Build/xdocs">
                <include name="**/*.gif"/>
                <include name="**/*.jpeg"/>
                <include name="**/*.jpg"/>
                <include name="**/*.png"/>
                <include name="**/*.css"/>
            </fileset>
        </copy>
    </target>
</project>
